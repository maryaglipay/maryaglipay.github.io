<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-07-03">

<title>Mary Aglipay - On the use of Cox PH for vaccine effectiveness/ factors associated with test positivity</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Mary Aglipay</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">On the use of Cox PH for vaccine effectiveness/ factors associated with test positivity</h1>
  <div class="quarto-categories">
    <div class="quarto-category">thesis</div>
    <div class="quarto-category">test-negative design</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 3, 2025</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>One of the things I am grappling with right now is trying to wrap my head around the study design and estimands for studies in which testing is a barrier to determining who is positive or not. This blog is really for me to refresh my memory as to how studies are biased when they don’t use the appropriate design in this setting.</p>
<p>As we know from this previous blog post, <a href="https://maryaglipay.github.io/posts/blog1/blog7.html" class="uri">https://maryaglipay.github.io/posts/blog1/blog7.html</a>, there are biases that result from treating people who don’t test as ‘uninfected’. Misclassification bias happens because those who don’t test are treated as ‘uninfected,’ for both the exposed and unexposed. This is compounded by confounding, because those who are more likely to seek healthcare are more likely to get vaccinated, and also more likely to test. Conversely, those less likely to seek healthcare are less likely to get vaccinated and less likely to test.</p>
<p>Consider the DAG below. These are our assumptions of the relationships between variables, with our association of interest in green.</p>
<p><img src="images/paste-1299799C.png" class="img-fluid">In a cohort study, we need to try to adjust for health-seeking behaviours in order to avoid bias by confounding. We are still left with misclassification bias though. If we consider this non-differential misclassification bias of the outcome (if we assume that we were able to take care of confounding by health-seeking behaviours), in most cases this will bias the result toward the null (see <span class="citation" data-cites="rothman2012">Rothman (<a href="#ref-rothman2012" role="doc-biblioref">2012</a>)</span>, page 135). Making our estimate conservative. However, ‘health-care seeking behaviours’ is a multifactorial concept that is challenging to fully adjust for, which may impact the misclassification, which can bias the result either way.</p>
<p><strong>But what about the test-negative study design, again?</strong></p>
<p>I think the idea behind the test-negative study is that by conditioning on those who test, we kind of have a pool of people with the same kinds of health seeking behaviours. So what happens is we have ‘adjusted’ for the confounder of health seeking behaviours by only including participants with the same access and propensity to be ‘healthy’.</p>
<p><img src="images/paste-27213C20.png" class="img-fluid"></p>
<p>However, <span class="citation" data-cites="sullivan2016">Sullivan, Tchetgen Tchetgen, and Cowling (<a href="#ref-sullivan2016" role="doc-biblioref">2016</a>)</span> argues that for the most part, health care seeking behaviours are not truly adjusted for by conditioning on those who test. That is, we don’t actually get rid of those arrows from health seeking behaviours to vaccination, infection, and testing- e.g.&nbsp;we can’t assume that the vaccinated and unvaccinated have similar distributions of health seeking behaviours, just because these are people who test. In fact, <span class="citation" data-cites="sullivan2016">Sullivan, Tchetgen Tchetgen, and Cowling (<a href="#ref-sullivan2016" role="doc-biblioref">2016</a>)</span> argues that it <em>introduces</em> bias by conditioning on a collider, testing, which opens a backdoor path vaccination<span class="math inline">\(\rightarrow\)</span> health seeking behaviour <span class="math inline">\(\rightarrow\)</span> testing <span class="math inline">\(\rightarrow\)</span> symptoms <span class="math inline">\(\rightarrow\)</span> infection. As a result, <span class="citation" data-cites="sullivan2016">Sullivan, Tchetgen Tchetgen, and Cowling (<a href="#ref-sullivan2016" role="doc-biblioref">2016</a>)</span> argues that health seeking behaviour must still be adjusted for in this scenario.</p>
<p>The test negative study comes with more implications. If we condition on those who test, what happens is that we open up a colliding path through testing (see <span class="citation" data-cites="schnitzer2022">Schnitzer (<a href="#ref-schnitzer2022" role="doc-biblioref">2022</a>)</span>) . And this is why we need to condition on symptoms! Because that is what effectively blocks this backdoor path. With some datasets, this can be challenging because symptoms are not well-collected through administrative data. Sometimes these authors call it a ‘pseudo test-negative design’ (see <span class="citation" data-cites="sundaram2021">Sundaram et al. (<a href="#ref-sundaram2021" role="doc-biblioref">2021</a>)</span>). Although this is not ideal, we can sometimes assume that everyone who presented for testing had symptoms (if for example, this is a requirement in government testing eligibility criteria. In the case of children, it could be argued that parents have more to lose by testing an asymptomatic child, therefore children who presented for testing may be more likely to be symptomatic).</p>
<p><strong>Estimands for cohort studies and test-negative designs where the outcome is determined by testing</strong></p>
<p>So in our study, we are looking at factors associated with time to first positive test in children and mothers. We are doing a cohort study in which we need to assume that children who did not present for testing did not get infected. Now, it is important to remember that we are looking at <em>predictors</em> of time to first positive test, so we are not exactly using a causal framework. What would happen if we used Cox proportional hazards?</p>
<p>I think similar to the <a href="https://maryaglipay.github.io/posts/blog1/blog7.html">previous blog</a>, we can turn to <span class="citation" data-cites="jackson2013">Jackson and Nelson (<a href="#ref-jackson2013" role="doc-biblioref">2013</a>)</span> for what might happen.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Screen Shot 2022-12-04 at 9.00.13 PM.png" class="img-fluid figure-img" alt="From @jackson2013" width="459"></p>
<p></p><figcaption class="figure-caption">From <span class="citation" data-cites="jackson2013">Jackson and Nelson (<a href="#ref-jackson2013" role="doc-biblioref">2013</a>)</span></figcaption><p></p>
</figure>
</div>
<p>In this case, those infected but did not seek care for their respiratory infection, cells D and J, will both have longer time to censoring, and will be incorrectly placed in cells C and I. Are D (vaccinated) and J (unvaccinated) misclassified in the same way? I.e. can we assume that D and J had equal lengths of follow-up? I think similar to the relative risks discussed earlier, if we can assume that health-seeking behaviour is well adjusted for, then this could be non-differential misclassification of the outcome, which would in most cases bias the association toward the null. In our study, we adjust for a number of health-seeking behaviours, including adherence to NPIs.</p>
<p><em>What about test-negative studies?</em></p>
<p>Why do test-negative studies need to use the odds ratio? When we are selecting for inclusion into a test-negative study, similar to a case-control study, we are selecting based on the outcome. This means that we don’t really have a ‘proper’ denominator for something like the relative risk- we manipulated (chose) the number of people who have the outcome, rather than randomly sampling from our target population. This means we don’t really know the marginal distribution of the outcome (i.e.&nbsp;we don’t know what the true prevalence of our outcome is in our target pop). Therefore, we need to use the odds ratio, which is invariant to the marginal distribution of the outcome!</p>
<p><strong>Target populations</strong></p>
<p>A final note on target populations. In a test-negative study, because we are only including those who test, our target population really focuses on people who can test also. In other words, we can only make inference to participants who access testing. However, the test negative study is relatively robust because we have “taken care” of the health seeking behaviour (supposedly), we sacrifice generalizability for internal validity.</p>
<p>In a cohort study, we are including everyone, so technically we are making inference to the larger population- people who test or who don’t. The problem is, it’s difficult to establish internal validity because of all the issues with misclassification and confounding due to health seeking behaviour. If we believe that we’ve taken care of the confounding, we’re still left with misclassification, which technically biases our result toward the null. We need to be willing to assume that this is true. But we still have questionable internal validity- and if we don’t have internal validity, then generalizability is not our biggest concern here.</p>
<p><strong>How do we think about factors associated with testing positive in the context of factors associated with testing in general?</strong></p>
<p>Say we ran two models. A model looking at factors associated with testing in general. And then another model looking at factors associated with testing positive. We found that factors associated with testing were age, sex, and height. Then, we found that factors associated with testing positive were income and education. How do we make sense of this information?</p>
<p>I guess it depends on if these models are independent— ie. if the outcomes are independent of each other. If we think that testing positive and testing alone are unrelated to each other, then it is what it is- we found that age, sex and height were associated with testing. And income and education were associated with testing positive. Our target population is the same- everybody. This means there’s a prediction model, applied to everyone, for who gets testing, and there’s a separate prediction model, for everyone, for who tests positive.</p>
<p>On the other hand, if our model is conditional on being tested, then we are thinking about two populations here. One where it’s everyone, and we’re looking at factors associated with testing. And another where it’s just people who tested, and we’re looking at factors associated with test positivity. This means that there’s a prediction model for who gets in the group, and there’s a prediction model of who tests positive once you’re in the group.</p>
<p><strong>Concluding remarks</strong></p>
<p>The question of how to handle studies in which the outcome is gated by testing behaviour is a challenging one. There are biases that we have to worry about for each type of study, cohort, test negative. Ideally, the outcome would not be gated by testing behaviour- we would have system-wide surveillance of infection. The reality is that surveillance is expensive, and this is not often data that is available to us. The use of test negative designs are an evolving conversation (see <span class="citation" data-cites="shi2023">Shi, Li, and Mukherjee (<a href="#ref-shi2023" role="doc-biblioref">2023</a>)</span>) and no doubt that I will be writing about this topic more!</p>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-jackson2013" class="csl-entry" role="doc-biblioentry">
Jackson, Michael L., and Jennifer C. Nelson. 2013. <span>“The Test-Negative Design for Estimating Influenza Vaccine Effectiveness.”</span> <em>Vaccine</em> 31 (17): 2165–68.
</div>
<div id="ref-rothman2012" class="csl-entry" role="doc-biblioentry">
Rothman, Kenneth J. 2012. <em>Epidemiology: An Introduction</em>. Oxford university press.
</div>
<div id="ref-schnitzer2022" class="csl-entry" role="doc-biblioentry">
Schnitzer, Mireille E. 2022. <span>“Estimands and Estimation of COVID-19 Vaccine Effectiveness Under the Test-Negative Design.”</span> <em>Epidemiology (Cambridge, Mass.)</em> 33 (3): 325–33. <a href="https://doi.org/10.1097/EDE.0000000000001470">https://doi.org/10.1097/EDE.0000000000001470</a>.
</div>
<div id="ref-shi2023" class="csl-entry" role="doc-biblioentry">
Shi, Xu, Kendrick Qijun Li, and Bhramar Mukherjee. 2023. <span>“Current Challenges with the Use of Test-Negative Designs for Modeling COVID-19 Vaccination and Outcomes.”</span> <em>American Journal of Epidemiology</em> 192 (3): 328–33. <a href="https://doi.org/10.1093/aje/kwac203">https://doi.org/10.1093/aje/kwac203</a>.
</div>
<div id="ref-sullivan2016" class="csl-entry" role="doc-biblioentry">
Sullivan, Sheena G., Eric J. Tchetgen Tchetgen, and Benjamin J. Cowling. 2016. <span>“Theoretical Basis of the Test-Negative Study Design for Assessment of Influenza Vaccine Effectiveness.”</span> <em>American Journal of Epidemiology</em> 184 (5): 345–53. <a href="https://doi.org/10.1093/aje/kww064">https://doi.org/10.1093/aje/kww064</a>.
</div>
<div id="ref-sundaram2021" class="csl-entry" role="doc-biblioentry">
Sundaram, Maria E., Andrew Calzavara, Sharmistha Mishra, Rafal Kustra, Adrienne K. Chan, Mackenzie A. Hamilton, Mohamed Djebli, et al. 2021. <span>“Individual and Social Determinants of SARS-CoV-2 Testing and Positivity in Ontario, Canada: A Population-Wide Study.”</span> <em>CMAJ</em> 193 (20): E723–34. <a href="https://doi.org/10.1503/cmaj.202608">https://doi.org/10.1503/cmaj.202608</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>